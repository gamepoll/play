<head>
  <!-- Plotly.js -->
	  <script src="https://code.jquery.com/jquery-2.1.4.min.js"> </script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>
	
<p id="demo"></p> 
	
<br />
<input id="text1" value="bochk" style="width: 100px;" />
<input id="text2" value="bochk" style="width: 100px;" />
<input type="button" value="BOCHK <=" id="button_2388" />
<input type="button" value="AAC Acoustic <=" id="button_2018" />
<input type="button" value="Suny Optics <=" id="button_2382" />
<input type="button" value="BYD etron <=" id="button_0285" />
<br />
__________<input type="button" value="Vep-Bdx =>" id="button_vb" />
<input type="button" value="Vx-Tx =>" id="button_vut" />


<div id="myDiv1" style="height:400px; width:1000px"></div>

<script>
$("#button_2388").on("click", function() { $("#text1").val("Bochk"); $("#text2").val("gsx$bochk");});
$('#button_2018').on('click', function() { $('#text1').val("tcehy"); });
$('#button_2382').on('click', function() { $('#text1').val("pek"); });
$('#button_0285').on('click', function() { $('#text1').val("byd"); });
$("#button_vb").on("click", function() { makeplot(); });


function makeplot() { 	
	var url2 = "https://spreadsheets.google.com/feeds/list/1NYOFCAHvMkyOxItQqqhFLvna-yXnMheQbuxVPMV43Dk/o7lhxur/public/values?alt=json"; 
	var foo = $("#text2").val();
	Plotly.d3.json(url2, function (error, result) { 
		var x = [], y = [], y2=[], y3=[]; 
		for (i = 0; i < result.feed.entry.length; i += 1) { 
			var source = result.feed.entry[i];
			x.push(result.feed.entry[i].gsx$date.$t); 
//			y.push(result.feed.entry[i].gsx$tsxbockhk.$t); 
// http://bl.ocks.org/tmaybe/6246014
			y.push(result.feed.entry[i].gsx$tsx.$t/result.feed.entry[i][$("#text2").val()].$t); 
			y2.push(result.feed.entry[i].gsx$bochk.$t); 
			y3.push(result.feed.entry[i].gsx$tsx.$t); 
		} 
		makePlotly2( x, y, y2, y3,"tsx" + $("#text1").val(), "bochky", "tsx","myDiv1"); 
	}); 
}; 

function makePlotly2( x, y, y2, y3, yname, y2name, y3name, divname){
	Plotly.purge(divname);
	var traces = { x: x, y: y, name: yname }; 
	var traces2 = { x: x, y: y2, name: y2name, 
						mode: 'lines+markers', 
						marker: { color: 'rgb(128, 0, 128)', size: 5 }, 
						yaxis: 'y2' 
					  }; 
	var traces3 = { x: x, y: y3, name: y3name, 
						mode: 'lines+markers', 
						marker: {  size: 5 }, 
						yaxis: 'y3' 
					  };
	var data = [traces, traces2, traces3]; 
	var layout = { title: yname, 
					  yaxis: {/*title: yname*/}, 
					  yaxis2: {// title: y2name, 

								  overlaying: 'y', side: 'right' } ,
					  yaxis3: {

								  overlaying: 'y', side: 'left' } ,
					 }; 
	Plotly.plot(divname, data, layout); 
}; 

//makeplot();

</script>

</body>
